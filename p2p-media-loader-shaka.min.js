require=function s(o,a,u){function c(t,e){if(!a[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[t]={exports:{}};o[t][0].call(i.exports,function(e){return c(o[t][1][e]||e)},i,i.exports,s,o,a,u)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,r){window.p2pml||(window.p2pml={}),window.p2pml.shaka=e("p2p-media-loader-shaka")},{"p2p-media-loader-shaka":"p2p-media-loader-shaka"}],2:[function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var s=e("./parser-segment"),o=function(){function e(e){this.cache=new s.ParserSegmentCache(200),this.originalManifestParser=e}return e.prototype.isHls=function(){return this.originalManifestParser instanceof shaka.hls.HlsParser},e.prototype.isDash=function(){return this.originalManifestParser instanceof shaka.dash.DashParser},e.prototype.start=function(e,t){var a=this;return this.originalManifestParser.start(e,t).then(function(e){for(var t=0,r=(a.manifest=e).periods;t<r.length;t++)for(var n=[],i=0,s=r[t].variants;i<s.length;i++){var o=s[i];null!=o.video&&-1==n.indexOf(o.video)&&(a.hookGetSegmentReference(o.video),n.push(o.video)),null!=o.audio&&-1==n.indexOf(o.audio)&&(a.hookGetSegmentReference(o.audio),n.push(o.audio))}return e.p2pml={parser:a},e})},e.prototype.configure=function(e){return this.originalManifestParser.configure(e)},e.prototype.stop=function(){return this.originalManifestParser.stop()},e.prototype.update=function(){return this.originalManifestParser.update()},e.prototype.onExpirationUpdated=function(){return this.originalManifestParser.onExpirationUpdated()},e.prototype.find=function(e,t){return this.cache.find(e,t)},e.prototype.reset=function(){this.cache.clear()},e.prototype.hookGetSegmentReference=function(t){var r=this;t.getSegmentReferenceOriginal=t.getSegmentReference,t.getSegmentReference=function(e){return r.cache.add(t,e),t.getSegmentReferenceOriginal(e)},t.getPosition=function(){return r.isHls()&&"video"===t.type?r.manifest.periods[0].variants.reduce(function(e,t){return t.video&&t.video.id&&!e.includes(t.video.id)&&e.push(t.video.id),e},[]).indexOf(t.id):-1}},e}(),a=function(e){function t(){return e.call(this,new shaka.dash.DashParser)||this}return i(t,e),t}(r.ShakaManifestParserProxy=o);r.ShakaDashManifestParserProxy=a;var u=function(e){function t(){return e.call(this,new shaka.hls.HlsParser)||this}return i(t,e),t}(o);r.ShakaHlsManifestParserProxy=u},{"./parser-segment":3}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var g=e("./utils"),n=function(){function p(e,t,r,n,i,s,o,a,u,c,l,d){this.streamId=e,this.streamType=t,this.streamPosition=r,this.streamIdentity=n,this.identity=i,this.position=s,this.start=o,this.end=a,this.uri=u,this.range=c,this.prev=l,this.next=d}return p.create=function(e,t){var r=e.getSegmentReferenceOriginal(t);if(r){var n=r.createUris();if(n&&0!==n.length){var i=r.getStartTime(),s=r.getEndTime(),o=r.getStartByte(),a=r.getEndByte(),u=o||a?"bytes="+(o||"")+"-"+(a||""):void 0,c=e.type.substring(0,1).toUpperCase(),l=e.getPosition(),d=0<=l,h=d?""+c+l:""+c+e.id,f=d?h+"+"+t:h+"+"+Number(i).toFixed(3);return new p(e.id,e.type,l,h,f,t,i,s,g.getSchemedUri(n[0]),u,function(){return p.create(e,t-1)},function(){return p.create(e,t+1)})}}},p}();r.ParserSegment=n;var i=function(){function e(e){this.segments=[],this.maxSegments=e}return e.prototype.find=function(t,r){return this.segments.find(function(e){return e.uri===t&&e.range===r})},e.prototype.add=function(e,t){var r=n.create(e,t);r&&!this.find(r.uri,r.range)&&(this.segments.push(r),this.segments.length>this.maxSegments&&this.segments.splice(0,.2*this.maxSegments))},e.prototype.clear=function(){this.segments.splice(0)},e}();r.ParserSegmentCache=i},{"./utils":5}],4:[function(e,t,r){"use strict";var n=this&&this.__awaiter||function(s,o,a,u){return new(a||(a=Promise))(function(e,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}i((u=u.apply(s,o||[])).next())})},a=this&&this.__generator||function(r,n){var i,s,o,e,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,s&&(o=2&t[0]?s.return:t[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,t[1])).done)return o;switch(s=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,s=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){a.label=t[1];break}if(6===t[0]&&a.label<o[1]){a.label=o[1],o=t;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(t);break}o[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],s=0}finally{i=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("debug"),u=e("p2p-media-loader-core"),s={forwardSequenceDuration:60,maxHistorySegments:100,simulateTimeDelation:!0},o=function(){function e(e,t){void 0===t&&(t={});var r=this;this.debug=i("p2pml:shaka:sm"),this.requests=new Map,this.manifestUri="",this.playheadTime=0,this.segmentHistory=[],this.settings=void 0,this.onSegmentLoaded=function(e){r.requests.has(e.id)&&(r.reportSuccess(r.requests.get(e.id),e),r.debug("request delete",e.id),r.requests.delete(e.id))},this.onSegmentError=function(e,t){r.requests.has(e.id)&&(r.reportError(r.requests.get(e.id),t),r.debug("request delete from error",e.id),r.requests.delete(e.id))},this.onSegmentAbort=function(e){r.requests.has(e.id)&&(r.reportError(r.requests.get(e.id),"Internal abort"),r.debug("request delete from abort",e.id),r.requests.delete(e.id))},this.settings=Object.assign(s,t),this.loader=e,this.loader.on(u.LoaderEvents.SegmentLoaded,this.onSegmentLoaded),this.loader.on(u.LoaderEvents.SegmentError,this.onSegmentError),this.loader.on(u.LoaderEvents.SegmentAbort,this.onSegmentAbort)}return e.prototype.isSupported=function(){return this.loader.isSupported()},e.prototype.setPlayheadTime=function(e){this.playheadTime=e,0<this.segmentHistory.length&&this.refreshLoad()},e.prototype.load=function(t,r,o){return n(this,void 0,void 0,function(){var n,i,s=this;return a(this,function(e){return this.manifestUri=r,this.playheadTime=o,this.pushSegmentHistory(t),n=this.refreshLoad(),i=this.loader.getSegment(n.id),[2,new Promise(function(e,t){var r=new c(n.id,e,t);i?s.reportSuccess(r,i):(s.debug("request add",r.id),s.requests.set(r.id,r))})]})})},e.prototype.refreshLoad=function(){var e=this.segmentHistory[this.segmentHistory.length-1],r=.1<this.playheadTime?this.playheadTime:e.start,t=this.segmentHistory.reduce(function(e,t){return t.start>=r&&e.push(t),e},[]);0===t.length&&t.push(e);var n=t.length-1,i=t.reduce(function(e,t){return e+t.end-t.start},0);do{var s=t[t.length-1].next();if(!s)break;t.push(s),i+=s.end-s.start}while(i<this.settings.forwardSequenceDuration);var o=this.manifestUri.split("?")[0],a=t.map(function(e,t){return new u.Segment(o+"+"+e.identity,e.uri,e.range,t)});return this.loader.load(a,o+"+"+e.streamIdentity),a[n]},e.prototype.destroy=function(){0!==this.requests.size&&(console.error("Destroying segment manager with active request(s)!"),this.requests.clear()),this.playheadTime=0,this.segmentHistory.splice(0),this.loader.destroy()},e.prototype.pushSegmentHistory=function(e){this.segmentHistory.length>=this.settings.maxHistorySegments&&(this.debug("segment history auto shrink"),this.segmentHistory.splice(0,.2*this.settings.maxHistorySegments)),0<this.segmentHistory.length&&this.segmentHistory[this.segmentHistory.length-1].start>e.start&&(this.debug("segment history reset due to playhead seek back"),this.segmentHistory.splice(0)),this.segmentHistory.push(e)},e.prototype.reportSuccess=function(e,t){var r=this;if(e.resolve){var n=0;if(this.settings.simulateTimeDelation&&0<t.downloadSpeed&&t.data&&0<t.data.byteLength){var i=Math.trunc(t.data.byteLength/t.downloadSpeed);n=Date.now()-e.timeCreated+i}setTimeout(function(){r.debug("report success",e.id),e.resolve(t.data)},n)}},e.prototype.reportError=function(e,t){e.reject&&(this.debug("report error",e.id),e.reject(t))},e}();r.default=o;var c=function(e,t,r){this.id=e,this.resolve=t,this.reject=r,this.timeCreated=Date.now()}},{debug:6,"p2p-media-loader-core":void 0}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getSchemedUri=function(e){return e.startsWith("//")?window.location.protocol+e:e}},{}],6:[function(r,n,s){(function(t){function e(){var e;try{e=s.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(s=n.exports=r("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},s.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+s.humanize(this.diff),!t)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))}),e.splice(i,0,r)},s.save=function(e){try{null==e?s.storage.removeItem("debug"):s.storage.debug=e}catch(e){}},s.load=e,s.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},s.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),s.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],s.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},s.enable(e())}).call(this,r("_process"))},{"./debug":7,_process:9}],7:[function(e,t,a){var u;function r(e){function n(){if(n.enabled){var i=n,e=+new Date,t=e-(u||e);i.diff=t,i.prev=u,i.curr=e,u=e;for(var s=new Array(arguments.length),r=0;r<s.length;r++)s[r]=arguments[r];s[0]=a.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var o=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;o++;var r=a.formatters[t];if("function"==typeof r){var n=s[o];e=r.call(i,n),s.splice(o,1),o--}return e}),a.formatArgs.call(i,s),(n.log||a.log||console.log.bind(console)).apply(i,s)}}return n.namespace=e,n.enabled=a.enabled(e),n.useColors=a.useColors(),n.color=function(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return a.colors[Math.abs(r)%a.colors.length]}(e),"function"==typeof a.init&&a.init(n),n}(a=t.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){a.enable("")},a.enable=function(e){a.save(e),a.names=[],a.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),r=t.length,n=0;n<r;n++)t[n]&&("-"===(e=t[n].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.substr(1)+"$")):a.names.push(new RegExp("^"+e+"$")))},a.enabled=function(e){var t,r;for(t=0,r=a.skips.length;t<r;t++)if(a.skips[t].test(e))return!1;for(t=0,r=a.names.length;t<r;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=e("ms"),a.names=[],a.skips=[],a.formatters={}},{ms:8}],8:[function(e,t,r){var i=36e5,s=864e5;function o(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}t.exports=function(e,t){t=t||{};var r,n=typeof e;if("string"===n&&0<e.length)return function(e){if(100<(e=String(e)).length)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?o(r=e,s,"day")||o(r,i,"hour")||o(r,6e4,"minute")||o(r,1e3,"second")||r+" ms":function(e){if(s<=e)return Math.round(e/s)+"d";if(i<=e)return Math.round(e/i)+"h";if(6e4<=e)return Math.round(e/6e4)+"m";if(1e3<=e)return Math.round(e/1e3)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],9:[function(e,t,r){var n,i,s=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var c,l=[],d=!1,h=-1;function f(){d&&c&&(d=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!d){var e=u(f);d=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new g(e,t)),1!==l.length||d||u(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],"p2p-media-loader-shaka":[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("debug"),s=e("p2p-media-loader-core"),o=e("./segment-manager"),a=e("./manifest-parser-proxy"),l=e("./utils"),d=n("p2pml:shaka:index"),u={segmentManager:void 0};function c(e,t,r){if(!t.p2pml||r!==shaka.net.NetworkingEngine.RequestType.SEGMENT)return shaka.net.HttpXHRPlugin(e,t,r);var n=t.p2pml,i=n.player,s=n.segmentManager,o=i.getManifest();if(!o||!o.p2pml)return shaka.net.HttpXHRPlugin(e,t,r);var a=o.p2pml.parser.find(e,t.headers.Range);if(!a||"video"!==a.streamType)return shaka.net.HttpXHRPlugin(e,t,r);var u=null;d("request","load",a.identity);var c=new Promise(function(t,e){u=e,s.load(a,l.getSchemedUri(i.getManifestUri()),h(i)).then(function(e){return t({data:e})})});return new shaka.util.AbortableOperation(c,function(){return d("request","abort",a.identity),u(new shaka.util.Error(shaka.util.Error.Severity.RECOVERABLE,shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.OPERATION_ABORTED))})}function h(e){var t=0,r=e.getPlayheadTimeAsDate();return r&&(t=r.valueOf(),e.isLive()&&(t-=e.getPresentationStartTimeAsDate().valueOf()),t/=1e3),t}r.initShakaPlayer=function(r,e){if(void 0===e&&(e={}),shaka){d("register parser proxies"),shaka.media.ManifestParser.registerParserByExtension("mpd",a.ShakaDashManifestParserProxy),shaka.media.ManifestParser.registerParserByMime("application/dash+xml",a.ShakaDashManifestParserProxy),shaka.media.ManifestParser.registerParserByExtension("m3u8",a.ShakaHlsManifestParserProxy),shaka.media.ManifestParser.registerParserByMime("application/x-mpegurl",a.ShakaHlsManifestParserProxy),shaka.media.ManifestParser.registerParserByMime("application/vnd.apple.mpegurl",a.ShakaHlsManifestParserProxy),d("init networking engine"),shaka.net.NetworkingEngine.registerScheme("http",c),shaka.net.NetworkingEngine.registerScheme("https",c);var n=(e=Object.assign(u,e)).segmentManager?e.segmentManager:new o.default(new s.HybridLoader);d("using segment manager",n);var t=0,i=0;r.addEventListener("loading",function(){0<t&&(clearInterval(t),t=0),i=0;var e=r.getManifest();e&&e.p2pml&&e.p2pml.parser.reset(),n.destroy(),t=setInterval(function(){var e=h(r);e!==i&&(n.setPlayheadTime(e),i=e)},1e3)}),d("register request filter"),r.getNetworkingEngine().registerRequestFilter(function(e,t){t.p2pml={player:r,segmentManager:n}})}else console.error("p2pml","window.shaka is not defined. Did you forget to include Shaka Player?")};var i=e("./segment-manager");r.SegmentManager=i.default},{"./manifest-parser-proxy":2,"./segment-manager":4,"./utils":5,debug:6,"p2p-media-loader-core":void 0}]},{},[1]);
